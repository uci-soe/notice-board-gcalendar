import React, { useEffect, useState } from 'react';
import PropTypes from 'prop-types';
import isToday from 'date-fns/is_today';
import './StudentSchedule.css';
import StudentScheduleEvent from './StudentScheduleEvent';
import { getDate, getEvents, MINUTE } from './lib/utils';
const propTypes = {
  range: PropTypes.number,
  timeMin: PropTypes.instanceOf(Date),
  timeMax: PropTypes.instanceOf(Date),
  children: PropTypes.any
};
const defaultProps = {
  range: 2,
  timeMin: getDate(-1),
  timeMax: getDate(1),
  updateTime: MINUTE * 10,
  apiKey: null,
  calendarID: null
};

function StudentSchedule(props) {
  const [events, setEvents] = useState([]);
  useEffect(() => {
    let update;

    const updateFunc = () => {
      getEvents(props.timeMin, props.timeMax, props.calendarID, props.apiKey).then(events => setEvents(events));
      update = setTimeout(() => {
        updateFunc();
      }, props.updateTime);
    };

    updateFunc();
    return () => {
      clearTimeout(update);
    };
  }, [props.timeMin, props.timeMax, props.updateTime, props.calendarID, props.apiKey]);
  const eventsToday = events.filter(e => isToday(e.start.dateTime));
  const Event = props.children || StudentScheduleEvent;
  return React.createElement("div", {
    className: "calendar-events"
  }, eventsToday.map((e, i) => Event(e, i)));
}

StudentSchedule.propTypes = propTypes;
StudentSchedule.defaultProps = defaultProps;
export default StudentSchedule;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9jb21wb25lbnRzL1N0dWRlbnRTY2hlZHVsZS5qcyJdLCJuYW1lcyI6WyJSZWFjdCIsInVzZUVmZmVjdCIsInVzZVN0YXRlIiwiUHJvcFR5cGVzIiwiaXNUb2RheSIsIlN0dWRlbnRTY2hlZHVsZUV2ZW50IiwiZ2V0RGF0ZSIsImdldEV2ZW50cyIsIk1JTlVURSIsInByb3BUeXBlcyIsInJhbmdlIiwibnVtYmVyIiwidGltZU1pbiIsImluc3RhbmNlT2YiLCJEYXRlIiwidGltZU1heCIsImNoaWxkcmVuIiwiYW55IiwiZGVmYXVsdFByb3BzIiwidXBkYXRlVGltZSIsImFwaUtleSIsImNhbGVuZGFySUQiLCJTdHVkZW50U2NoZWR1bGUiLCJwcm9wcyIsImV2ZW50cyIsInNldEV2ZW50cyIsInVwZGF0ZSIsInVwZGF0ZUZ1bmMiLCJ0aGVuIiwic2V0VGltZW91dCIsImNsZWFyVGltZW91dCIsImV2ZW50c1RvZGF5IiwiZmlsdGVyIiwiZSIsInN0YXJ0IiwiZGF0ZVRpbWUiLCJFdmVudCIsIm1hcCIsImkiXSwibWFwcGluZ3MiOiJBQUFBLE9BQU9BLEtBQVAsSUFBZUMsU0FBZixFQUEwQkMsUUFBMUIsUUFBeUMsT0FBekM7QUFDQSxPQUFPQyxTQUFQLE1BQXNCLFlBQXRCO0FBQ0EsT0FBT0MsT0FBUCxNQUFvQixtQkFBcEI7QUFFQSxPQUFPLHVCQUFQO0FBQ0EsT0FBT0Msb0JBQVAsTUFBaUMsd0JBQWpDO0FBQ0EsU0FBUUMsT0FBUixFQUFpQkMsU0FBakIsRUFBNEJDLE1BQTVCLFFBQXlDLGFBQXpDO0FBRUEsTUFBTUMsU0FBUyxHQUFHO0FBQ2hCQyxFQUFBQSxLQUFLLEVBQUVQLFNBQVMsQ0FBQ1EsTUFERDtBQUVoQkMsRUFBQUEsT0FBTyxFQUFFVCxTQUFTLENBQUNVLFVBQVYsQ0FBcUJDLElBQXJCLENBRk87QUFHaEJDLEVBQUFBLE9BQU8sRUFBRVosU0FBUyxDQUFDVSxVQUFWLENBQXFCQyxJQUFyQixDQUhPO0FBSWhCRSxFQUFBQSxRQUFRLEVBQUViLFNBQVMsQ0FBQ2M7QUFKSixDQUFsQjtBQU9BLE1BQU1DLFlBQVksR0FBRztBQUNuQlIsRUFBQUEsS0FBSyxFQUFFLENBRFk7QUFFbkJFLEVBQUFBLE9BQU8sRUFBRU4sT0FBTyxDQUFDLENBQUMsQ0FBRixDQUZHO0FBR25CUyxFQUFBQSxPQUFPLEVBQUVULE9BQU8sQ0FBQyxDQUFELENBSEc7QUFJbkJhLEVBQUFBLFVBQVUsRUFBRVgsTUFBTSxHQUFHLEVBSkY7QUFLbkJZLEVBQUFBLE1BQU0sRUFBRSxJQUxXO0FBTW5CQyxFQUFBQSxVQUFVLEVBQUU7QUFOTyxDQUFyQjs7QUFTQSxTQUFTQyxlQUFULENBQXlCQyxLQUF6QixFQUFnQztBQUM5QixRQUFNLENBQUNDLE1BQUQsRUFBU0MsU0FBVCxJQUFzQnZCLFFBQVEsQ0FBQyxFQUFELENBQXBDO0FBRUFELEVBQUFBLFNBQVMsQ0FBQyxNQUFNO0FBQ2QsUUFBSXlCLE1BQUo7O0FBQ0EsVUFBTUMsVUFBVSxHQUFHLE1BQU07QUFDdkJwQixNQUFBQSxTQUFTLENBQUNnQixLQUFLLENBQUNYLE9BQVAsRUFBZ0JXLEtBQUssQ0FBQ1IsT0FBdEIsRUFBK0JRLEtBQUssQ0FBQ0YsVUFBckMsRUFBaURFLEtBQUssQ0FBQ0gsTUFBdkQsQ0FBVCxDQUNHUSxJQURILENBQ1FKLE1BQU0sSUFBSUMsU0FBUyxDQUFDRCxNQUFELENBRDNCO0FBR0FFLE1BQUFBLE1BQU0sR0FBR0csVUFBVSxDQUFDLE1BQU07QUFDeEJGLFFBQUFBLFVBQVU7QUFDWCxPQUZrQixFQUVoQkosS0FBSyxDQUFDSixVQUZVLENBQW5CO0FBR0QsS0FQRDs7QUFTQVEsSUFBQUEsVUFBVTtBQUVWLFdBQU8sTUFBTTtBQUNYRyxNQUFBQSxZQUFZLENBQUNKLE1BQUQsQ0FBWjtBQUNELEtBRkQ7QUFHRCxHQWhCUSxFQWdCTixDQUFDSCxLQUFLLENBQUNYLE9BQVAsRUFBZ0JXLEtBQUssQ0FBQ1IsT0FBdEIsRUFBK0JRLEtBQUssQ0FBQ0osVUFBckMsRUFBaURJLEtBQUssQ0FBQ0YsVUFBdkQsRUFBbUVFLEtBQUssQ0FBQ0gsTUFBekUsQ0FoQk0sQ0FBVDtBQWtCQSxRQUFNVyxXQUFXLEdBQUdQLE1BQU0sQ0FBQ1EsTUFBUCxDQUFlQyxDQUFELElBQU83QixPQUFPLENBQUM2QixDQUFDLENBQUNDLEtBQUYsQ0FBUUMsUUFBVCxDQUE1QixDQUFwQjtBQUNBLFFBQU1DLEtBQUssR0FBR2IsS0FBSyxDQUFDUCxRQUFOLElBQWtCWCxvQkFBaEM7QUFDQSxTQUNFO0FBQUssSUFBQSxTQUFTLEVBQUM7QUFBZixLQUNHMEIsV0FBVyxDQUFDTSxHQUFaLENBQWdCLENBQUNKLENBQUQsRUFBSUssQ0FBSixLQUFVRixLQUFLLENBQUNILENBQUQsRUFBSUssQ0FBSixDQUEvQixDQURILENBREY7QUFLRDs7QUFFRGhCLGVBQWUsQ0FBQ2IsU0FBaEIsR0FBNEJBLFNBQTVCO0FBQ0FhLGVBQWUsQ0FBQ0osWUFBaEIsR0FBK0JBLFlBQS9CO0FBRUEsZUFBZUksZUFBZiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBSZWFjdCwge3VzZUVmZmVjdCwgdXNlU3RhdGV9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBQcm9wVHlwZXMgZnJvbSAncHJvcC10eXBlcyc7XG5pbXBvcnQgaXNUb2RheSBmcm9tICdkYXRlLWZucy9pc190b2RheSc7XG5cbmltcG9ydCAnLi9TdHVkZW50U2NoZWR1bGUuY3NzJztcbmltcG9ydCBTdHVkZW50U2NoZWR1bGVFdmVudCBmcm9tICcuL1N0dWRlbnRTY2hlZHVsZUV2ZW50JztcbmltcG9ydCB7Z2V0RGF0ZSwgZ2V0RXZlbnRzLCBNSU5VVEV9IGZyb20gJy4vbGliL3V0aWxzJztcblxuY29uc3QgcHJvcFR5cGVzID0ge1xuICByYW5nZTogUHJvcFR5cGVzLm51bWJlcixcbiAgdGltZU1pbjogUHJvcFR5cGVzLmluc3RhbmNlT2YoRGF0ZSksXG4gIHRpbWVNYXg6IFByb3BUeXBlcy5pbnN0YW5jZU9mKERhdGUpLFxuICBjaGlsZHJlbjogUHJvcFR5cGVzLmFueVxufTtcblxuY29uc3QgZGVmYXVsdFByb3BzID0ge1xuICByYW5nZTogMixcbiAgdGltZU1pbjogZ2V0RGF0ZSgtMSksXG4gIHRpbWVNYXg6IGdldERhdGUoMSksXG4gIHVwZGF0ZVRpbWU6IE1JTlVURSAqIDEwLFxuICBhcGlLZXk6IG51bGwsXG4gIGNhbGVuZGFySUQ6IG51bGxcbn07XG5cbmZ1bmN0aW9uIFN0dWRlbnRTY2hlZHVsZShwcm9wcykge1xuICBjb25zdCBbZXZlbnRzLCBzZXRFdmVudHNdID0gdXNlU3RhdGUoW10pO1xuXG4gIHVzZUVmZmVjdCgoKSA9PiB7XG4gICAgbGV0IHVwZGF0ZTtcbiAgICBjb25zdCB1cGRhdGVGdW5jID0gKCkgPT4ge1xuICAgICAgZ2V0RXZlbnRzKHByb3BzLnRpbWVNaW4sIHByb3BzLnRpbWVNYXgsIHByb3BzLmNhbGVuZGFySUQsIHByb3BzLmFwaUtleSlcbiAgICAgICAgLnRoZW4oZXZlbnRzID0+IHNldEV2ZW50cyhldmVudHMpKTtcblxuICAgICAgdXBkYXRlID0gc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgIHVwZGF0ZUZ1bmMoKTtcbiAgICAgIH0sIHByb3BzLnVwZGF0ZVRpbWUpO1xuICAgIH07XG5cbiAgICB1cGRhdGVGdW5jKCk7XG5cbiAgICByZXR1cm4gKCkgPT4ge1xuICAgICAgY2xlYXJUaW1lb3V0KHVwZGF0ZSk7XG4gICAgfVxuICB9LCBbcHJvcHMudGltZU1pbiwgcHJvcHMudGltZU1heCwgcHJvcHMudXBkYXRlVGltZSwgcHJvcHMuY2FsZW5kYXJJRCwgcHJvcHMuYXBpS2V5XSk7XG5cbiAgY29uc3QgZXZlbnRzVG9kYXkgPSBldmVudHMuZmlsdGVyKChlKSA9PiBpc1RvZGF5KGUuc3RhcnQuZGF0ZVRpbWUpKTtcbiAgY29uc3QgRXZlbnQgPSBwcm9wcy5jaGlsZHJlbiB8fCBTdHVkZW50U2NoZWR1bGVFdmVudDtcbiAgcmV0dXJuIChcbiAgICA8ZGl2IGNsYXNzTmFtZT0nY2FsZW5kYXItZXZlbnRzJz5cbiAgICAgIHtldmVudHNUb2RheS5tYXAoKGUsIGkpID0+IEV2ZW50KGUsIGkpKX1cbiAgICA8L2Rpdj5cbiAgKTtcbn1cblxuU3R1ZGVudFNjaGVkdWxlLnByb3BUeXBlcyA9IHByb3BUeXBlcztcblN0dWRlbnRTY2hlZHVsZS5kZWZhdWx0UHJvcHMgPSBkZWZhdWx0UHJvcHM7XG5cbmV4cG9ydCBkZWZhdWx0IFN0dWRlbnRTY2hlZHVsZTsiXX0=