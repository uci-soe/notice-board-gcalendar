import React, { useEffect, useState } from 'react';
import PropTypes from 'prop-types';
import { setDays, getEvents, getDate, MINUTE } from './lib/utils';
import './TechSchedule.css';
import TechScheduleEvent from './TechScheduleEvent';
const propTypes = {
  range: PropTypes.number,
  timeMin: PropTypes.instanceOf(Date),
  timeMax: PropTypes.instanceOf(Date),
  children: PropTypes.any
};
const defaultProps = {
  range: 2,
  timeMin: getDate(-1),
  timeMax: getDate(14),
  updateTime: MINUTE * 10,
  apiKey: null,
  calendarID: null
};

function TechSchedule(props) {
  const [events, setEvents] = useState([]);
  useEffect(() => {
    let update;

    const updateFunc = () => {
      getEvents(props.timeMin, props.timeMax, props.calendarID, props.apiKey).then(events => setEvents(events));
      update = setTimeout(() => {
        updateFunc();
      }, props.updateTime);
    };

    updateFunc();
    return () => {
      clearTimeout(update);
    };
  }, [props.timeMin, props.timeMax, props.updateTime, props.calendarID, props.apiKey]);
  const eventsTodayAndTmr = setDays(events, props.range);
  const Event = props.children || TechScheduleEvent;
  return React.createElement("div", {
    className: "calendar-events"
  }, eventsTodayAndTmr.map((e, i) => Event(e, i)));
}

TechSchedule.propTypes = propTypes;
TechSchedule.defaultProps = defaultProps;
export default TechSchedule;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uL3NyYy9jb21wb25lbnRzL1RlY2hTY2hlZHVsZS5qcyJdLCJuYW1lcyI6WyJSZWFjdCIsInVzZUVmZmVjdCIsInVzZVN0YXRlIiwiUHJvcFR5cGVzIiwic2V0RGF5cyIsImdldEV2ZW50cyIsImdldERhdGUiLCJNSU5VVEUiLCJUZWNoU2NoZWR1bGVFdmVudCIsInByb3BUeXBlcyIsInJhbmdlIiwibnVtYmVyIiwidGltZU1pbiIsImluc3RhbmNlT2YiLCJEYXRlIiwidGltZU1heCIsImNoaWxkcmVuIiwiYW55IiwiZGVmYXVsdFByb3BzIiwidXBkYXRlVGltZSIsImFwaUtleSIsImNhbGVuZGFySUQiLCJUZWNoU2NoZWR1bGUiLCJwcm9wcyIsImV2ZW50cyIsInNldEV2ZW50cyIsInVwZGF0ZSIsInVwZGF0ZUZ1bmMiLCJ0aGVuIiwic2V0VGltZW91dCIsImNsZWFyVGltZW91dCIsImV2ZW50c1RvZGF5QW5kVG1yIiwiRXZlbnQiLCJtYXAiLCJlIiwiaSJdLCJtYXBwaW5ncyI6IkFBQUEsT0FBT0EsS0FBUCxJQUFlQyxTQUFmLEVBQTBCQyxRQUExQixRQUF5QyxPQUF6QztBQUNBLE9BQU9DLFNBQVAsTUFBc0IsWUFBdEI7QUFDQSxTQUFRQyxPQUFSLEVBQWlCQyxTQUFqQixFQUE0QkMsT0FBNUIsRUFBcUNDLE1BQXJDLFFBQWtELGFBQWxEO0FBRUEsT0FBTyxvQkFBUDtBQUNBLE9BQU9DLGlCQUFQLE1BQThCLHFCQUE5QjtBQUVBLE1BQU1DLFNBQVMsR0FBRztBQUNoQkMsRUFBQUEsS0FBSyxFQUFFUCxTQUFTLENBQUNRLE1BREQ7QUFFaEJDLEVBQUFBLE9BQU8sRUFBRVQsU0FBUyxDQUFDVSxVQUFWLENBQXFCQyxJQUFyQixDQUZPO0FBR2hCQyxFQUFBQSxPQUFPLEVBQUVaLFNBQVMsQ0FBQ1UsVUFBVixDQUFxQkMsSUFBckIsQ0FITztBQUloQkUsRUFBQUEsUUFBUSxFQUFFYixTQUFTLENBQUNjO0FBSkosQ0FBbEI7QUFPQSxNQUFNQyxZQUFZLEdBQUc7QUFDbkJSLEVBQUFBLEtBQUssRUFBRSxDQURZO0FBRW5CRSxFQUFBQSxPQUFPLEVBQUVOLE9BQU8sQ0FBQyxDQUFDLENBQUYsQ0FGRztBQUduQlMsRUFBQUEsT0FBTyxFQUFFVCxPQUFPLENBQUMsRUFBRCxDQUhHO0FBSW5CYSxFQUFBQSxVQUFVLEVBQUVaLE1BQU0sR0FBRyxFQUpGO0FBS25CYSxFQUFBQSxNQUFNLEVBQUUsSUFMVztBQU1uQkMsRUFBQUEsVUFBVSxFQUFFO0FBTk8sQ0FBckI7O0FBU0EsU0FBU0MsWUFBVCxDQUFzQkMsS0FBdEIsRUFBNkI7QUFDM0IsUUFBTSxDQUFDQyxNQUFELEVBQVNDLFNBQVQsSUFBc0J2QixRQUFRLENBQUMsRUFBRCxDQUFwQztBQUVBRCxFQUFBQSxTQUFTLENBQUMsTUFBTTtBQUNkLFFBQUl5QixNQUFKOztBQUNBLFVBQU1DLFVBQVUsR0FBRyxNQUFNO0FBQ3ZCdEIsTUFBQUEsU0FBUyxDQUFDa0IsS0FBSyxDQUFDWCxPQUFQLEVBQWdCVyxLQUFLLENBQUNSLE9BQXRCLEVBQStCUSxLQUFLLENBQUNGLFVBQXJDLEVBQWlERSxLQUFLLENBQUNILE1BQXZELENBQVQsQ0FDR1EsSUFESCxDQUNRSixNQUFNLElBQUlDLFNBQVMsQ0FBQ0QsTUFBRCxDQUQzQjtBQUdBRSxNQUFBQSxNQUFNLEdBQUdHLFVBQVUsQ0FBQyxNQUFNO0FBQ3hCRixRQUFBQSxVQUFVO0FBQ1gsT0FGa0IsRUFFaEJKLEtBQUssQ0FBQ0osVUFGVSxDQUFuQjtBQUdELEtBUEQ7O0FBU0FRLElBQUFBLFVBQVU7QUFFVixXQUFPLE1BQU07QUFDWEcsTUFBQUEsWUFBWSxDQUFDSixNQUFELENBQVo7QUFDRCxLQUZEO0FBR0QsR0FoQlEsRUFnQk4sQ0FBQ0gsS0FBSyxDQUFDWCxPQUFQLEVBQWdCVyxLQUFLLENBQUNSLE9BQXRCLEVBQStCUSxLQUFLLENBQUNKLFVBQXJDLEVBQWlESSxLQUFLLENBQUNGLFVBQXZELEVBQW1FRSxLQUFLLENBQUNILE1BQXpFLENBaEJNLENBQVQ7QUFrQkEsUUFBTVcsaUJBQWlCLEdBQUczQixPQUFPLENBQUNvQixNQUFELEVBQVNELEtBQUssQ0FBQ2IsS0FBZixDQUFqQztBQUNBLFFBQU1zQixLQUFLLEdBQUdULEtBQUssQ0FBQ1AsUUFBTixJQUFrQlIsaUJBQWhDO0FBQ0EsU0FDSTtBQUFLLElBQUEsU0FBUyxFQUFDO0FBQWYsS0FDR3VCLGlCQUFpQixDQUFDRSxHQUFsQixDQUFzQixDQUFDQyxDQUFELEVBQUlDLENBQUosS0FBVUgsS0FBSyxDQUFDRSxDQUFELEVBQUlDLENBQUosQ0FBckMsQ0FESCxDQURKO0FBS0Q7O0FBRURiLFlBQVksQ0FBQ2IsU0FBYixHQUF5QkEsU0FBekI7QUFDQWEsWUFBWSxDQUFDSixZQUFiLEdBQTRCQSxZQUE1QjtBQUVBLGVBQWVJLFlBQWYiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgUmVhY3QsIHt1c2VFZmZlY3QsIHVzZVN0YXRlfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgUHJvcFR5cGVzIGZyb20gJ3Byb3AtdHlwZXMnO1xuaW1wb3J0IHtzZXREYXlzLCBnZXRFdmVudHMsIGdldERhdGUsIE1JTlVURX0gZnJvbSAnLi9saWIvdXRpbHMnO1xuXG5pbXBvcnQgJy4vVGVjaFNjaGVkdWxlLmNzcyc7XG5pbXBvcnQgVGVjaFNjaGVkdWxlRXZlbnQgZnJvbSAnLi9UZWNoU2NoZWR1bGVFdmVudCc7XG5cbmNvbnN0IHByb3BUeXBlcyA9IHtcbiAgcmFuZ2U6IFByb3BUeXBlcy5udW1iZXIsXG4gIHRpbWVNaW46IFByb3BUeXBlcy5pbnN0YW5jZU9mKERhdGUpLFxuICB0aW1lTWF4OiBQcm9wVHlwZXMuaW5zdGFuY2VPZihEYXRlKSxcbiAgY2hpbGRyZW46IFByb3BUeXBlcy5hbnlcbn07XG5cbmNvbnN0IGRlZmF1bHRQcm9wcyA9IHtcbiAgcmFuZ2U6IDIsXG4gIHRpbWVNaW46IGdldERhdGUoLTEpLFxuICB0aW1lTWF4OiBnZXREYXRlKDE0KSxcbiAgdXBkYXRlVGltZTogTUlOVVRFICogMTAsXG4gIGFwaUtleTogbnVsbCxcbiAgY2FsZW5kYXJJRDogbnVsbFxufTtcblxuZnVuY3Rpb24gVGVjaFNjaGVkdWxlKHByb3BzKSB7XG4gIGNvbnN0IFtldmVudHMsIHNldEV2ZW50c10gPSB1c2VTdGF0ZShbXSk7XG5cbiAgdXNlRWZmZWN0KCgpID0+IHtcbiAgICBsZXQgdXBkYXRlO1xuICAgIGNvbnN0IHVwZGF0ZUZ1bmMgPSAoKSA9PiB7XG4gICAgICBnZXRFdmVudHMocHJvcHMudGltZU1pbiwgcHJvcHMudGltZU1heCwgcHJvcHMuY2FsZW5kYXJJRCwgcHJvcHMuYXBpS2V5KVxuICAgICAgICAudGhlbihldmVudHMgPT4gc2V0RXZlbnRzKGV2ZW50cykpO1xuXG4gICAgICB1cGRhdGUgPSBzZXRUaW1lb3V0KCgpID0+IHtcbiAgICAgICAgdXBkYXRlRnVuYygpO1xuICAgICAgfSwgcHJvcHMudXBkYXRlVGltZSk7XG4gICAgfTtcblxuICAgIHVwZGF0ZUZ1bmMoKTtcblxuICAgIHJldHVybiAoKSA9PiB7XG4gICAgICBjbGVhclRpbWVvdXQodXBkYXRlKTtcbiAgICB9XG4gIH0sIFtwcm9wcy50aW1lTWluLCBwcm9wcy50aW1lTWF4LCBwcm9wcy51cGRhdGVUaW1lLCBwcm9wcy5jYWxlbmRhcklELCBwcm9wcy5hcGlLZXldKTtcblxuICBjb25zdCBldmVudHNUb2RheUFuZFRtciA9IHNldERheXMoZXZlbnRzLCBwcm9wcy5yYW5nZSk7XG4gIGNvbnN0IEV2ZW50ID0gcHJvcHMuY2hpbGRyZW4gfHwgVGVjaFNjaGVkdWxlRXZlbnQ7XG4gIHJldHVybiAoXG4gICAgICA8ZGl2IGNsYXNzTmFtZT0nY2FsZW5kYXItZXZlbnRzJz5cbiAgICAgICAge2V2ZW50c1RvZGF5QW5kVG1yLm1hcCgoZSwgaSkgPT4gRXZlbnQoZSwgaSkpfVxuICAgICAgPC9kaXY+XG4gICk7XG59XG5cblRlY2hTY2hlZHVsZS5wcm9wVHlwZXMgPSBwcm9wVHlwZXM7XG5UZWNoU2NoZWR1bGUuZGVmYXVsdFByb3BzID0gZGVmYXVsdFByb3BzO1xuXG5leHBvcnQgZGVmYXVsdCBUZWNoU2NoZWR1bGU7Il19